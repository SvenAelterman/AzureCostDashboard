{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "BillingDashboardDev"
		},
		"DashboardSQLService_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'DashboardSQLService'"
		},
		"AzureKeyVault_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://JamesDevAzureKeyVault.vault.azure.net/"
		},
		"AzureManagementApi_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://management.azure.com/"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/AzureKeyVault')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('AzureKeyVault_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureManagementApi')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('AzureManagementApi_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DashboardSQLService')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('DashboardSQLService_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/BillingAccounts')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureManagementApi",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": "/providers/Microsoft.Billing/billingAccounts?includeCAID=true&api-version=2019-10-01-preview"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"value": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"id": {
										"type": "string"
									},
									"name": {
										"type": "string"
									},
									"properties": {
										"type": "object",
										"properties": {
											"accountId": {
												"type": "string"
											},
											"accountStatus": {
												"type": "string"
											},
											"accountType": {
												"type": "string"
											},
											"agreementType": {
												"type": "string"
											},
											"displayName": {
												"type": "string"
											},
											"hasReadAccess": {
												"type": "boolean"
											},
											"organizationId": {
												"type": "string"
											}
										}
									},
									"type": {
										"type": "string"
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureManagementApi')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/BillingSubscriptions')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureManagementApi",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"BillingAccountId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@concat(dataset().BillingAccountId, '/billingSubscriptions?api-version=2019-10-01-preview&excludeCharges=true')",
							"type": "Expression"
						}
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"totalCount": {
							"type": "integer"
						},
						"value": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"id": {
										"type": "string"
									},
									"name": {
										"type": "string"
									},
									"properties": {
										"type": "object",
										"properties": {
											"billingProfileId": {
												"type": "string"
											},
											"billingProfileDisplayName": {
												"type": "string"
											},
											"displayName": {
												"type": "string"
											},
											"invoiceSectionId": {
												"type": "string"
											},
											"invoiceSectionDisplayName": {
												"type": "string"
											},
											"skuId": {
												"type": "string"
											},
											"skuDescription": {
												"type": "string"
											},
											"subscriptionBillingStatus": {
												"type": "string"
											},
											"subscriptionBillingStatusReasonDetails": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"effectiveDate": {
															"type": "string"
														},
														"subscriptionBillingStatusReason": {
															"type": "string"
														}
													}
												}
											},
											"spendingLimitDetails": {
												"type": "object",
												"properties": {
													"amount": {
														"type": "number"
													},
													"currency": {
														"type": "string"
													},
													"endDate": {
														"type": "string"
													},
													"type": {
														"type": "string"
													},
													"startDate": {
														"type": "string"
													},
													"status": {
														"type": "string"
													}
												}
											},
											"subscriptionId": {
												"type": "string"
											}
										}
									},
									"type": {
										"type": "string"
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureManagementApi')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Costs')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureManagementApi",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"resourceGroupId": {
						"type": "string",
						"defaultValue": "/subscriptions/89e6ade6-e91a-4152-bf83-9c83a3cb6ae3/resourceGroups/FMCSPortalResourceGroup"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@concat(dataset().resourceGroupId, '/providers/Microsoft.CostManagement/query?api-version=2021-10-01&$top=5000')",
							"type": "Expression"
						}
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"id": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"type": {
							"type": "string"
						},
						"location": {
							"type": "null"
						},
						"sku": {
							"type": "null"
						},
						"eTag": {
							"type": "null"
						},
						"properties": {
							"type": "object",
							"properties": {
								"nextLink": {
									"type": "null"
								},
								"columns": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"name": {
												"type": "string"
											},
											"type": {
												"type": "string"
											}
										}
									}
								},
								"rows": {
									"type": "array",
									"items": {
										"type": "array",
										"items": {
											"type": "number"
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureManagementApi')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PriceLists')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureManagementApi",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"subscriptionId": {
						"type": "string",
						"defaultValue": "89e6ade6-e91a-4152-bf83-9c83a3cb6ae3"
					},
					"nextLink": {
						"type": "string"
					},
					"armRegionName": {
						"type": "string",
						"defaultValue": "eastus"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@if(empty(dataset().nextLink), concat('subscriptions/', dataset().subscriptionId,'/providers/Microsoft.Consumption/pricesheets/default?api-version=2020-01-01-preview&$filter=armRegionName eq ''', dataset().armRegionName, '''' ), replace(dataset().nextLink, 'https://management.azure.com:443', ''))",
							"type": "Expression"
						}
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"BillingCurrency": {
							"type": "string"
						},
						"CustomerEntityId": {
							"type": "string"
						},
						"CustomerEntityType": {
							"type": "string"
						},
						"Items": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"currencyCode": {
										"type": "string"
									},
									"tierMinimumUnits": {
										"type": "number"
									},
									"retailPrice": {
										"type": "number"
									},
									"unitPrice": {
										"type": "number"
									},
									"discount": {
										"type": "number"
									},
									"armRegionName": {
										"type": "string"
									},
									"location": {
										"type": "string"
									},
									"effectiveStartDate": {
										"type": "string"
									},
									"meterId": {
										"type": "string"
									},
									"meterName": {
										"type": "string"
									},
									"productId": {
										"type": "string"
									},
									"skuId": {
										"type": "string"
									},
									"productName": {
										"type": "string"
									},
									"skuName": {
										"type": "string"
									},
									"serviceName": {
										"type": "string"
									},
									"serviceId": {
										"type": "string"
									},
									"serviceFamily": {
										"type": "string"
									},
									"unitOfMeasure": {
										"type": "string"
									},
									"type": {
										"type": "string"
									},
									"isPrimaryMeterRegion": {
										"type": "boolean"
									},
									"armSkuName": {
										"type": "string"
									}
								}
							}
						},
						"NextPageLink": {
							"type": "string"
						},
						"Count": {
							"type": "integer"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureManagementApi')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ResourceGroups')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureManagementApi",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"subscriptionId": {
						"type": "string",
						"defaultValue": "89e6ade6-e91a-4152-bf83-9c83a3cb6ae3"
					},
					"nextLink": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@if(empty(dataset().nextLink), concat('subscriptions/', dataset().subscriptionId,'/resourcegroups?api-version=2017-05-10'), replace(dataset().nextLink, 'https://management.azure.com', ''))",
							"type": "Expression"
						}
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"value": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"id": {
										"type": "string"
									},
									"authorizationSource": {
										"type": "string"
									},
									"managedByTenants": {
										"type": "array"
									},
									"subscriptionId": {
										"type": "string"
									},
									"tenantId": {
										"type": "string"
									},
									"displayName": {
										"type": "string"
									},
									"state": {
										"type": "string"
									},
									"subscriptionPolicies": {
										"type": "object",
										"properties": {
											"locationPlacementId": {
												"type": "string"
											},
											"quotaId": {
												"type": "string"
											},
											"spendingLimit": {
												"type": "string"
											}
										}
									}
								}
							}
						},
						"count": {
							"type": "object",
							"properties": {
								"type": {
									"type": "string"
								},
								"value": {
									"type": "integer"
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureManagementApi')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Resources')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureManagementApi",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"resourceGroupPath": {
						"type": "string",
						"defaultValue": "/subscriptions/89e6ade6-e91a-4152-bf83-9c83a3cb6ae3/resourceGroups/FMCSPortalResourceGroup"
					},
					"nextLink": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": {
							"value": "@if(empty(dataset().nextLink), concat(dataset().resourceGroupPath, '/resources?api-version=2021-04-01'), dataset().nextLink)",
							"type": "Expression"
						}
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"value": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"id": {
										"type": "string"
									},
									"name": {
										"type": "string"
									},
									"type": {
										"type": "string"
									},
									"sku": {
										"type": "object",
										"properties": {
											"name": {
												"type": "string"
											},
											"tier": {
												"type": "string"
											},
											"size": {
												"type": "string"
											},
											"family": {
												"type": "string"
											},
											"capacity": {
												"type": "integer"
											}
										}
									},
									"kind": {
										"type": "string"
									},
									"location": {
										"type": "string"
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureManagementApi')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_BillingAccounts')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Id",
						"type": "nvarchar"
					},
					{
						"name": "Name",
						"type": "nvarchar"
					},
					{
						"name": "AccountId",
						"type": "nvarchar"
					},
					{
						"name": "AccountStatus",
						"type": "nvarchar"
					},
					{
						"name": "AccountType",
						"type": "nvarchar"
					},
					{
						"name": "AgreementType",
						"type": "nvarchar"
					},
					{
						"name": "DisplayName",
						"type": "nvarchar"
					},
					{
						"name": "OrganizationId",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "BillingAccounts"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_BillingSubscriptions')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "AccountId",
						"type": "nvarchar"
					},
					{
						"name": "SubscriptionId",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "BillingSubscriptions"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_Budgets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Id",
						"type": "nvarchar"
					},
					{
						"name": "Name",
						"type": "nvarchar"
					},
					{
						"name": "StartDate",
						"type": "date"
					},
					{
						"name": "EndDate",
						"type": "date"
					},
					{
						"name": "Amount",
						"type": "float",
						"precision": 15
					},
					{
						"name": "SubscriptionId",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Budgets"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_Costs')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ResourceId",
						"type": "nvarchar"
					},
					{
						"name": "Cost",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "CostUSD",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "UsageDate",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Currency",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Costs"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_DataFlowCosts')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "JsonResult",
						"type": "nvarchar"
					},
					{
						"name": "ResourceId",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "DataFlowCosts"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_ExecuteTSQL')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_PriceLists')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "CurrencyCode",
						"type": "nvarchar"
					},
					{
						"name": "TierMinimumUnits",
						"type": "float",
						"precision": 15
					},
					{
						"name": "RetailPrice",
						"type": "float",
						"precision": 15
					},
					{
						"name": "UnitPrice",
						"type": "float",
						"precision": 15
					},
					{
						"name": "Discount",
						"type": "float",
						"precision": 15
					},
					{
						"name": "ArmRegionName",
						"type": "nvarchar"
					},
					{
						"name": "Location",
						"type": "nvarchar"
					},
					{
						"name": "EffectiveStartDate",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "MeterId",
						"type": "uniqueidentifier"
					},
					{
						"name": "MeterName",
						"type": "nvarchar"
					},
					{
						"name": "ProductId",
						"type": "nvarchar"
					},
					{
						"name": "SkuId",
						"type": "nvarchar"
					},
					{
						"name": "ProductName",
						"type": "nvarchar"
					},
					{
						"name": "SkuName",
						"type": "nvarchar"
					},
					{
						"name": "ServiceName",
						"type": "nvarchar"
					},
					{
						"name": "ServiceId",
						"type": "nvarchar"
					},
					{
						"name": "ServiceFamily",
						"type": "nvarchar"
					},
					{
						"name": "UnitOfMeasure",
						"type": "nvarchar"
					},
					{
						"name": "Type",
						"type": "nvarchar"
					},
					{
						"name": "isPrimaryMeterRegion",
						"type": "bit"
					},
					{
						"name": "ArmSkuName",
						"type": "nvarchar"
					},
					{
						"name": "SubscriptionId",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "PriceLists"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_ResourceGroups')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Id",
						"type": "nvarchar"
					},
					{
						"name": "SubscriptionId",
						"type": "nvarchar"
					},
					{
						"name": "Name",
						"type": "nvarchar"
					},
					{
						"name": "Location",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "ResourceGroups"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_Resources')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Id",
						"type": "nvarchar"
					},
					{
						"name": "ResourceGroupId",
						"type": "nvarchar"
					},
					{
						"name": "Name",
						"type": "nvarchar"
					},
					{
						"name": "Type",
						"type": "nvarchar"
					},
					{
						"name": "Kind",
						"type": "nvarchar"
					},
					{
						"name": "Location",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Resources"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_Subscribers')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Id",
						"type": "nvarchar"
					},
					{
						"name": "AuthorizationSource",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Subscriptions"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SQL_UsageAggregates')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DashboardSQLService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "SubscriptionId",
						"type": "uniqueidentifier"
					},
					{
						"name": "UsageStartTime",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "UsageEndTime",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "MeterName",
						"type": "nvarchar"
					},
					{
						"name": "MeterCategory",
						"type": "nvarchar"
					},
					{
						"name": "MeterSubCategory",
						"type": "nvarchar"
					},
					{
						"name": "Unit",
						"type": "nvarchar"
					},
					{
						"name": "InstanceData",
						"type": "nvarchar"
					},
					{
						"name": "MeterId",
						"type": "uniqueidentifier"
					},
					{
						"name": "Quantity",
						"type": "float",
						"precision": 15
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "UsageAggregates"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DashboardSQLService')]"
			]
		}
	]
}